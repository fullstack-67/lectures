---
marp: true
theme: default
class:
  - invert
author: Nirand Pisutha-Arnond
paginate: true
footer: "261497: Fullstack Development"
---

<style>
@import url('https://fonts.googleapis.com/css2?family=Prompt:ital,wght@0,100;0,300;0,400;0,700;1,100;1,300;1,400;1,700&display=swap');

    :root {
    font-family: Prompt;
    --hl-color: #D57E7E;
}
h1 {
  font-family: Prompt
}
</style>

# Fullstack Development

---

# Fullstack Landscape

> How to over-engineer "todo" apps

---

# 5 Ways to make Todo apps

- Multi-Page Applications (MPA)
- Single-Page Applications (SPA)
- React Server Components (RSC)
- RSC + Client Components (React's New Architecture)
- HTMX

---

# Round 1

> Multi-Page Application (MPA) vs Single-Page Application (SPA)

---

# Multi-page application

- Loads a new page every time you perform an action.
- Traditional web applications.
- Use server-side technologies
  - PHP, Ruby on Rails, ASP.NET, Java, and Node JS.
- Can include JavaScript (`script`) for client-side interactivity

---

![width:900](./img/mpa.jpg)

---

# Todo app (MPA)

- `Express JS` + `Pug` (renderer)

---

# Get started

- `npm install -g pnpm`
  - I am using `pnpm`.
- `git clone -b mpa https://github.com/fullstack-67/landscape-server`
- `cd landscape-server`
- `pnpm install`
- `npm run dev`

---

# Endpoint

`./src/index.ts`

```ts
app.get("/", async (req, res) => {
  const message = req.query?.message ?? "";
  const todos = await getTodos();
  // Output HTML
  res.render("pages/index", {
    todos,
    message,
    mode: "ADD",
    curTodo: { id: "", todoText: "" },
  });
});
```

---

# Renderer

`./view/pages/index.pug`

```ts
body
    main(class="container")
        a(href="/")
            h1 Todo (MPA)
        div(id="todoform")
            include ../components/inputform.pug
        div(id="todolist")
            include ../components/todolist.pug
```

---

![width:1000](./img/mpa_loading.jpg)

_Use incognito mode to avoid loading chrome extensions._

---

# Note

- Every button is wrapped in a separate form
  - Need to trigger different endpoints.
- Need to use `input(type="hidden)` to encode additional information.

```js
form(action="/delete" method="POST" style="display: contents")
  input(type="hidden" value=`${todo.id}` name="curId")
  button(type="submit" class="contrast" style="margin-bottom: 0") 🗑️
form(action="/edit" method="POST" style="display: contents")
  input(type="hidden" value=`${todo.id}` name="curId")
  button(type="submit" class="secondary" style="margin-bottom: 0") 🖊️
```

---

![](./img/mpa_type.png)

---

# Single-page application

- Single-page application
  - Loads a single HTML page and dynamically updates the content as the user interacts with the app.
- Use frontend and backend frameworks separately.

---

![width:900](./img/spa.jpg)

---

# Todo app (SPA)

- `Express JS` + `React`

---

# Get started

- `git clone https://github.com/fullstack-67/landscape-spa`
- Backend
  - `cd backend`
  - `pnpm install`
  - `npm run dev`
- Frontend
  - `cd frontend`
  - `pnpm install`
  - `npm run build`
  - `npm run preview`

---

![width:1000](./img/spa_loading.jpg)

---

![](./img/spa_type.png)

---

# Global store

- `zustand`
  ![width:700](./img/global_store.png)

---

# App comparison (UX)

| Item              | MPA | SPA |
| ----------------- | --- | --- |
| No page-refresh   | ❌  | ✅  |
| Spinner           | ❌  | ✅  |
| Element disabling | ❌  | ✅  |

---

# App comparison (technical)

| Item                  | MPA | SPA |
| --------------------- | --- | --- |
| Amount of `JS` loaded | ✅  | ❌  |
| HTML content (SEO)    | ✅  | ❌  |
| State in URL          | ✅  | ❌  |

---

# DX

| Item                 | MPA        | SPA     |
| -------------------- | ---------- | ------- |
| Number of frameworks | 1 ✅       | 2 ❌    |
| Complexity           | Less ✅    | More ❌ |
| Lines of code        | Less ✅    | More ❌ |
| Type Safety          | Less ❌    | More ✅ |
| Hot reloading        | Partial ❌ | Full ✅ |

---

# Amount of Codes

| Dir              | # Files | Total Lines |
| :--------------- | ------: | ----------: |
| _MPA_            |         |             |
| `./src`          |       2 |         161 |
| `./views`        |       3 |          42 |
| _SPA_            |         |             |
| `./backend/src`  |       2 |         144 |
| `./frontend/src` |      10 |      😭 360 |

---

# Round 2

> Back to the server. (Next JS)

---

# Server-Side Rendering (SSR)

- `SSR`
  - Generating the HTML for a web page on the server before sending it to the client’s browser.
- `CSR` (Client-Side Rendering)
  - Browser loads a minimal HTML file and fetches and renders the content using JavaScript.

---

# Next JS

- `V12`
  - SSR can only be done through top-level component (_page level_).
  - Use `getServerSideProps` function.
- `V13` (and above)
  - SSR can be done through a special components called
    - [_React Server Components_](https://www.joshwcomeau.com/react/server-components/).

---

# React's new architecture

- Client component
- Server component
- Server action
  - Asynchronous functions that are executed on the server.
  - Alternative to [API routes](https://nextjs.org/docs/app/building-your-application/routing/route-handlers).

---

# Todo App (RSC Only)

- `git clone -b rsc-only https://github.com/fullstack-67/landscape-hybrid.git`
- `cd landscape-hybrid`
- `pnpm install`
- `npm run build`
- `npm run start`

---

# Server components

`./src/app/page.tsx`

```ts
export default async function Home({ params, searchParams }: PageProps) {
  const todos = await getTodos();
  //...
  return <main className="container">...</main>;
}
```

- Async function
- Data fetching without `useEffect`.
  - It only runs once on the _server_. (Try `console.log`)
- Returns HTML to client.

---

# Round 3

> Enlightment

---

- Hypermedia-driven application - HTMX
